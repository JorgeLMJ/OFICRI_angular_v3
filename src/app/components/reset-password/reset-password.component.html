<div class="container d-flex align-items-center justify-content-center vh-100">
  <div class="card shadow-lg p-4" style="max-width: 450px; width: 100%;">
    
    <!-- Encabezado -->
    <div class="text-center mb-4">
      <i class="bi bi-shield-lock text-primary" style="font-size: 3rem;"></i>
      <h3 class="mt-2 text-primary">Restablecer Contraseña</h3>
      <p class="text-muted">Crea una contraseña segura para continuar</p>
    </div>

    <!-- ✅ Mensajes -->
    <div *ngIf="successMessage" class="alert alert-success alert-dismissible fade show text-center" role="alert">
      <i class="bi bi-check-circle-fill me-2"></i> {{ successMessage }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show text-center" role="alert">
      <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ errorMessage }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- Formulario -->
    <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" novalidate>
      
      <!-- Nueva contraseña -->
      <div class="mb-3">
        <label class="form-label fw-bold">Nueva Contraseña</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-key-fill"></i></span>
          <input 
            [type]="showPassword ? 'text' : 'password'"
            class="form-control"
            formControlName="newPassword"
            placeholder="••••••••"
            required>
          <button type="button" class="btn btn-outline-secondary" (click)="togglePassword('new')">
            <i [class]="showPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>
        <div *ngIf="resetForm.get('newPassword')?.touched && resetForm.get('newPassword')?.invalid" class="text-danger mt-1">
          <small *ngIf="resetForm.get('newPassword')?.errors?.['required']">
            La contraseña es obligatoria.
          </small>
          <small *ngIf="resetForm.get('newPassword')?.errors?.['minlength']">
            Debe tener al menos 8 caracteres.
          </small>
          <small *ngIf="resetForm.get('newPassword')?.errors?.['pattern']">
            Debe incluir mayúsculas, minúsculas, un número y un carácter especial.
          </small>
        </div>
      </div>

      <!-- Confirmar contraseña -->
      <div class="mb-4">
        <label class="form-label fw-bold">Confirmar Contraseña</label>
        <div class="input-group">
          <span class="input-group-text"><i class="bi bi-shield-check"></i></span>
          <input 
            [type]="showConfirmPassword ? 'text' : 'password'"
            class="form-control"
            formControlName="confirmPassword"
            placeholder="••••••••"
            required>
          <button type="button" class="btn btn-outline-secondary" (click)="togglePassword('confirm')">
            <i [class]="showConfirmPassword ? 'bi bi-eye-slash' : 'bi bi-eye'"></i>
          </button>
        </div>
        <div *ngIf="resetForm.get('confirmPassword')?.touched && resetForm.get('confirmPassword')?.invalid" class="text-danger mt-1">
          <small>Debes confirmar la contraseña.</small>
        </div>
        <div *ngIf="resetForm.errors?.['passwordMismatch'] && resetForm.get('confirmPassword')?.touched" class="text-danger mt-1">
          <small>Las contraseñas no coinciden.</small>
        </div>
      </div>

      <!-- Botón -->
      <button class="btn btn-primary w-100" type="submit" [disabled]="resetForm.invalid">
        <i class="bi bi-arrow-repeat me-2"></i> Restablecer Contraseña
      </button>

      <!-- Link volver -->
      <div class="text-center">
        <small>
          ¿Ya recuerdas tu contraseña? 
          <a href="/login" class="fw-bold text-decoration-none text-primary">Inicia sesión aquí</a>
        </small>
      </div>
    </form>
  </div>
</div>

